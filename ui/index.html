<!DOCTYPE html>
<html>
<head>

<title>Churn Intelligence</title>

<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">

<style>

*{
    box-sizing:border-box;
}

body{
    font-family:'Open Sans', sans-serif;
    font-weight:300;
    background:#f5f6f7;
    display:flex;
    justify-content:center;
    align-items:center;
    min-height:100vh;
    margin:0;
}


.container{
    width:760px;
    background:white;
    border-radius:14px;
    padding:45px;
    box-shadow:0 10px 40px rgba(0,0,0,0.06);
}


h1{
    text-align:center;
    font-weight:300;
    margin-bottom:6px;

    background:linear-gradient(
        90deg,
        #555,
        #999
    );

    -webkit-background-clip:text;
    -webkit-text-fill-color:transparent;
}

.subtitle{
    text-align:center;
    color:#8a8a8a;
    margin-bottom:40px;
    font-size:14px;
}


.form-grid{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:18px;
}

.full{
    grid-column:span 2;
}


input, select{
    width:100%;
    padding:12px;
    border-radius:8px;
    border:1px solid #e2e2e2;
    font-family:'Open Sans';
    font-weight:300;
    background:#fbfbfb;
    transition:0.2s;
}

input:focus, select:focus{
    outline:none;
    border-color:#cfcfcf;
    background:white;
}


button{
    padding:14px;
    border:none;
    border-radius:9px;
    background:#2b2b2b;
    color:white;
    font-weight:300;
    letter-spacing:0.5px;
    cursor:pointer;
    transition:0.25s;
    box-shadow:0 6px 18px rgba(0,0,0,0.08);
}

button:hover{
    background:#1f1f1f;
}


.result{
    margin-top:45px;
    padding:28px;
    border-radius:12px;
    background:#fafafa;
    box-shadow:0 8px 25px rgba(0,0,0,0.05);
    display:none;
}


.badge{
    text-align:center;
    padding:16px;
    border-radius:10px;
    font-size:18px;
    letter-spacing:0.5px;
    margin-bottom:18px;
}


.low{
    background:#f1f1f1;
}

.mild{
    background:#e4e4e4;
}

.high{
    background:#d6d6d6;
}


.bar{
    height:12px;
    background:#e8e8e8;
    border-radius:8px;
    overflow:hidden;
}

.progress{
    height:100%;
    width:0%;
    background:#7a7a7a;
    transition:width 0.6s ease;
}

.prob{
    text-align:center;
    margin-top:12px;
    color:#666;
}

.spinner{
    display:none;
    text-align:center;
    margin-top:18px;
    color:#777;
}


@media(max-width:820px){

.container{
    width:92%;
    padding:30px;
}

.form-grid{
    grid-template-columns:1fr;
}

.full{
    grid-column:span 1;
}

}

</style>
</head>

<body>

<div class="container">

<h1>Churn Intelligence</h1>
<div class="subtitle">
Predict customer churn risk with machine learning
</div>

<form id="form" class="form-grid">

<input id="tenure" type="number" placeholder="Tenure Months" required>
<input id="session" type="number" step="0.1" placeholder="Avg Session Duration" required>

<input id="sessions" type="number" placeholder="Sessions Last 30 Days" required>
<input id="usage" type="number" step="0.01" placeholder="Feature Usage Score (0â€“1)" required>

<input id="tickets" type="number" placeholder="Support Tickets" required>
<input id="login" type="number" placeholder="Last Login Days Ago" required>

<input id="spend" type="number" step="0.01" placeholder="Monthly Spend USD" required>
<input id="failures" type="number" placeholder="Payment Failures" required>

<select id="plan">
<option value="free">Free Plan</option>
<option value="basic">Basic</option>
<option value="pro">Pro</option>
<option value="enterprise">Enterprise</option>
</select>

<select id="region">
<option value="NA">North America</option>
<option value="EU">Europe</option>
<option value="APAC">APAC</option>
<option value="LATAM">LATAM</option>
</select>

<select id="annual" class="full">
<option value="1">Annual Plan</option>
<option value="0">Monthly Plan</option>
</select>

<button class="full" type="submit">
Predict Risk
</button>

</form>

<div class="spinner" id="spinner">
Running prediction...
</div>

<div class="result" id="result">

<div id="badge" class="badge"></div>

<div class="bar">
<div id="progress" class="progress"></div>
</div>

<div class="prob">
Probability: <b id="prob"></b>
</div>

</div>

</div>

<script>

document.getElementById("form").addEventListener("submit", async function(e){

e.preventDefault();

spinner.style.display="block";
result.style.display="none";

const payload = {
tenure_months: parseInt(tenure.value),
avg_session_duration: parseFloat(session.value),
sessions_last_30_days: parseInt(sessions.value),
feature_usage_score: parseFloat(usage.value),
support_tickets_last_90_days: parseInt(tickets.value),
last_login_days_ago: parseInt(login.value),
monthly_spend_usd: parseFloat(spend.value),
payment_failures_last_6m: parseInt(failures.value),
plan_type: plan.value,
region: region.value,
is_annual_plan: parseInt(annual.value)
};

const res = await fetch("/predict",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify(payload)
});

const data = await res.json();

spinner.style.display="none";
result.style.display="block";

const probability = data.churn_probability;
const percent = (probability * 100).toFixed(1);

document.getElementById("prob").innerText = percent + "%";
progress.style.width = percent + "%";

const badge = document.getElementById("badge");


if(probability < 0.35){

badge.className="badge low";
badge.innerText="LOW CHURN RISK";

}
else if(probability < 0.65){

badge.className="badge mild";
badge.innerText="MILD CHURN RISK";

}
else{

badge.className="badge high";
badge.innerText="HIGH CHURN RISK";

}

});

</script>

</body>
</html>
